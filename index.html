<!DOCTYPE html>
<html lang="hu">
<head>
    <link rel="manifest" href="https://progressier.app/PyNzJwKC4bFKTngyYc82/progressier.json"/>
    <script defer src="https://progressier.app/PyNzJwKC4bFKTngyYc82/script.js"></script>
    <link rel="shortcut icon" href="/favicon.ico">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>*KRISHAPPS SHOPSYSTEM*</title>
    <style>
        /* Alap st√≠lusok */
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f0f4f8;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            transition: background-color 0.3s, color 0.3s;
        }

        body.dark-mode {
            background-color: #1a1a1a;
            color: #ffffff;
        }

        .container {
            background-color: #ffffff;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            text-align: center;
            width: 60%;
            max-width: 600px;
            transition: background-color 0.3s, color 0.3s;
        }

        body.dark-mode .container {
            background-color: #333;
            color: #ffffff;
        }

        h1 {
            color: #333;
            margin-bottom: 20px;
        }

        body.dark-mode h1 {
            color: #ffffff;
        }

        input[type="number"],
        input[type="text"],
        select {
            padding: 15px;
            font-size: 18px;
            border: 1px solid #ccc;
            border-radius: 5px;
            width: 80%;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            transition: background-color 0.3s, color 0.3s;
        }

        body.dark-mode input[type="number"],
        body.dark-mode input[type="text"],
        body.dark-mode select {
            background-color: #444;
            color: #ffffff;
            border-color: #666;
        }

        button {
            padding: 12px 20px;
            font-size: 18px;
            color: #ffffff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            margin: 5px;
        }

        button#addButton {
            background-color: #007bff;
        }

        button#addButton:hover {
            background-color: #0056b3;
        }

        button#calculateButton {
            background-color: #ff9800;
        }

        button#calculateButton:hover {
            background-color: #f57c00;
        }

        button.deleteButton {
            background-color: red;
        }

        button.deleteButton:hover {
            background-color: #a00;
        }

        button#printButton {
            background-color: #28a745;
        }

        button#printButton:hover {
            background-color: #218838;
        }

        button#restartButton {
            background-color: #ff9800;
        }

        button#restartButton:hover {
            background-color: #f57c00;
        }

        .hidden {
            display: none;
        }

        .big-text {
            font-size: 100px;
            font-weight: bold;
            color: #2c3e50;
            margin: 20px 0;
        }

        body.dark-mode .big-text {
            color: #ffffff;
        }

        .number-list {
            text-align: left;
            margin: 20px 0;
            padding: 10px;
            background-color: #e9ecef;
            border-radius: 5px;
            transition: background-color 0.3s, color 0.3s;
        }

        body.dark-mode .number-list {
            background-color: #444;
        }

        .number-item {
            font-size: 18px;
            margin: 5px 0;
            padding: 10px;
            border: 1px solid #007bff;
            border-radius: 5px;
            background-color: #ffffff;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background-color 0.3s, color 0.3s;
        }

        body.dark-mode .number-item {
            background-color: #555;
            color: #ffffff;
        }

        .footer-text {
            font-size: 12px;
            color: #555;
            margin-top: 20px;
            text-align: center;
        }

        body.dark-mode .footer-text {
            color: #ccc;
        }

        .dark-mode-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #333;
        }

        body.dark-mode .dark-mode-toggle {
            color: #ffffff;
        }

        .data-matrix-placeholder {
            background-color: #e9ecef;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            font-size: 18px;
            color: #555;
            margin: 20px 0;
        }

        body.dark-mode .data-matrix-placeholder {
            background-color: #444;
            color: #ccc;
        }
    </style>
</head>
<body>
    <button class="dark-mode-toggle" id="darkModeToggle">üåô</button>
    <div class="container">
        <h1 id="title">Add meg a term√©kek √°r√°t!</h1>
        <div id="input-section">
            <input type="number" id="inputNumber" placeholder="Adj hozz√° egy sz√°mot..." onkeypress="checkEnter(event)">
            <input type="text" id="inputName" placeholder="Term√©k neve (opcion√°lis)">
            <input type="number" id="inputQuantity" placeholder="Darabsz√°m (alap√©rtelmezett: 1)" value="1" min="1">
            <select id="currencySelector">
                <option value="HUF">HUF</option>
                <option value="EUR">EUR</option>
                <option value="USD">USD</option>
            </select>
            <br>
            <button id="addButton" onclick="addNumber()">Hozz√°ad√°s</button>
            <button id="calculateButton" onclick="calculateTotal()">Kisz√°mol√°s</button>
            <div class="number-list" id="numberList"></div>
        </div>

        <div id="output-section" class="hidden">
            <p id="outputText" class="big-text"></p>
            <p id="convertedText"></p>
            <p id="vatText"></p>
            <div id="dataMatrixPlaceholder" class="data-matrix-placeholder">
                V√°laszd ki a fizet√©si m√≥dot, √©s a PDF417 vonalk√≥d meg fog jelenni.
            </div>
            <img id="dataMatrix" class="hidden" alt="PDF417 vonalk√≥d">
            <div class="footer-text hidden" id="footerText">
                K√âSZ√çTVE A KRISHAPPS SHOPSYSTEM √ÅLTAL<br>
                NAV ELLEN≈êRZ≈ê K√ìD: KS822<br>
                AP: A08220123
            </div>
            <select id="paymentMethod" class="hidden" onchange="updateDataMatrix()">
                <option value="">V√°lassz fizet√©si m√≥dot</option>
                <option value="V√°s√°rl√≥i/Aj√°nd√©kk√°rtya">V√°s√°rl√≥i/Aj√°nd√©kk√°rtya</option>
                <option value="K√©szp√©nz">K√©szp√©nz</option>
                <option value="Bankk√°rtya">Bankk√°rtya</option>
            </select>
            <button id="printButton" class="hidden" onclick="printText()">Nyomtat√°s</button>
            <button id="restartButton" class="hidden" onclick="restartPage()">√öjra</button>
        </div>
    </div>

    <script>
        let items = [];
        let exchangeRates = { EUR: 400, USD: 370 }; // P√©lda √°rfolyamok (1 EUR = 400 HUF, 1 USD = 370 HUF)
        let darkMode = localStorage.getItem('darkMode') === 'true';

        // S√∂t√©t m√≥d be√°ll√≠t√°sa
        function setDarkMode(isDark) {
            darkMode = isDark;
            localStorage.setItem('darkMode', darkMode);
            document.body.classList.toggle('dark-mode', darkMode);
            document.getElementById('darkModeToggle').innerText = darkMode ? '‚òÄÔ∏è' : 'üåô';
        }

        // S√∂t√©t m√≥d v√°lt√≥
        document.getElementById('darkModeToggle').addEventListener('click', () => {
            setDarkMode(!darkMode);
        });

        // Oldal bet√∂lt√©sekor s√∂t√©t m√≥d vissza√°ll√≠t√°sa
        setDarkMode(darkMode);

        function addNumber() {
            const number = parseFloat(document.getElementById("inputNumber").value);
            const name = document.getElementById("inputName").value || "√ÅRU";
            const quantity = parseInt(document.getElementById("inputQuantity").value) || 1;

            if (!isNaN(number)) {
                items.push({ name, number, quantity });

                const numberItem = document.createElement("div");
                numberItem.classList.add("number-item");
                numberItem.innerText = `${name} (${number} Ft x ${quantity} db)`;

                const deleteButton = document.createElement("button");
                deleteButton.innerText = "-";
                deleteButton.classList.add("deleteButton");
                deleteButton.onclick = function () {
                    removeItem(number, numberItem);
                };

                numberItem.appendChild(deleteButton);
                document.getElementById("numberList").appendChild(numberItem);

                document.getElementById("inputNumber").value = '';
                document.getElementById("inputName").value = '';
                document.getElementById("inputQuantity").value = 1;
            }
        }

        function removeItem(number, element) {
            items = items.filter(item => item.number !== number);
            element.remove();
        }

        function checkEnter(event) {
            if (event.key === "Enter") {
                addNumber();
                event.preventDefault();
            }
        }

        function calculateTotal() {
            if (items.length > 0) {
                const totalHUF = items.reduce((sum, item) => sum + item.number * item.quantity, 0);
                const currency = document.getElementById("currencySelector").value;
                let totalConverted = totalHUF;

                if (currency === "EUR") {
                    totalConverted = (totalHUF / exchangeRates.EUR).toFixed(2);
                } else if (currency === "USD") {
                    totalConverted = (totalHUF / exchangeRates.USD).toFixed(2);
                }

                document.getElementById("outputText").innerText = `V√©g√∂sszeg: ${totalConverted} ${currency}`;

                // √Åtv√°ltott √∂sszegek dinamikusan
                const totalEUR = (totalHUF / exchangeRates.EUR).toFixed(2);
                const totalUSD = (totalHUF / exchangeRates.USD).toFixed(2);

                let convertedText = "";
                if (currency === "HUF") {
                    convertedText = `Doll√°rban: ${totalUSD} USD, Eur√≥ban: ${totalEUR} EUR`;
                } else if (currency === "EUR") {
                    convertedText = `Forintban: ${totalHUF} Ft, Doll√°rban: ${totalUSD} USD`;
                } else if (currency === "USD") {
                    convertedText = `Forintban: ${totalHUF} Ft, Eur√≥ban: ${totalEUR} EUR`;
                }

                document.getElementById("convertedText").innerText = convertedText;

                // √ÅFA n√©lk√ºli √∂sszeg
                const totalWithoutVAT = (totalHUF * 0.73).toFixed(2);
                document.getElementById("vatText").innerText = `√Åfa n√©lk√ºl: (-27%) ${totalWithoutVAT} Ft`;

                document.getElementById("title").classList.add("hidden");
                document.getElementById("input-section").classList.add("hidden");
                document.getElementById("output-section").classList.remove("hidden");

                // Fizet√©si m√≥d v√°laszt√≥ √©s gombok megjelen√≠t√©se
                document.getElementById("paymentMethod").classList.remove("hidden");
                updateDataMatrix(); // Automatikusan friss√≠ti a vonalk√≥dot
            } else {
                alert("K√©rlek, adj hozz√° legal√°bb egy term√©ket!");
            }
        }

        function updateDataMatrix() {
            const paymentMethod = document.getElementById("paymentMethod").value;
            const printButton = document.getElementById("printButton");
            const restartButton = document.getElementById("restartButton");

            if (paymentMethod) {
                let paymentShort = "";
                if (paymentMethod === "K√©szp√©nz") {
                    paymentShort = "kp";
                } else if (paymentMethod === "Bankk√°rtya") {
                    paymentShort = "bk";
                } else if (paymentMethod === "V√°s√°rl√≥i/Aj√°nd√©kk√°rtya") {
                    paymentShort = "va";
                }

                const totalHUF = items.reduce((sum, item) => sum + item.number * item.quantity, 0);
                const dataMatrixURL = `http://bwipjs-api.metafloor.com/?bcid=pdf417&text=https://v-s.krishapps.com/?q=${totalHUF}-${paymentShort}`;
                const dataMatrixImage = document.getElementById("dataMatrix");
                dataMatrixImage.src = dataMatrixURL;
                dataMatrixImage.classList.remove("hidden");
                document.getElementById("dataMatrixPlaceholder").classList.add("hidden");

                // Gombok megjelen√≠t√©se, ha a fizet√©si m√≥d √©rv√©nyes
                printButton.classList.remove("hidden");
                restartButton.classList.remove("hidden");
            } else {
                // Ha nincs fizet√©si m√≥d kiv√°lasztva, rejtsd el a gombokat
                printButton.classList.add("hidden");
                restartButton.classList.add("hidden");
                document.getElementById("dataMatrix").classList.add("hidden");
                document.getElementById("dataMatrixPlaceholder").classList.remove("hidden");
            }
        }

        function restartPage() {
            location.reload();
        }

        function printText() {
            const paymentMethod = document.getElementById("paymentMethod").value;
            const printWindow = window.open("", "_blank", "width=600,height=400");
            printWindow.document.write('<html><head><title>Nyomtat√°s</title></head><body>');
            printWindow.document.write('<p style="font-family: Arial; font-size: 48px; text-align: center; color: darkblue; font-weight: bold;">KRISHAPPS SHOP</p>');
            printWindow.document.write(`<p style="font-family: Arial; font-size: 48px; text-align: center; color: darkblue; font-weight: bold;">Fizet√©si m√≥d: ${paymentMethod}</p>`);
            printWindow.document.write('<ul style="font-family: Arial; font-size: 24px; color: darkblue; list-style-type: none; padding: 0; text-align: center;">');

            items.forEach(item => {
                printWindow.document.write(`<li>${item.name} (${item.number} Ft x ${item.quantity} db)</li>`);
            });

            const totalHUF = items.reduce((sum, item) => sum + item.number * item.quantity, 0);
            const currency = document.getElementById("currencySelector").value;
            let totalConverted = totalHUF;

            if (currency === "EUR") {
                totalConverted = (totalHUF / exchangeRates.EUR).toFixed(2);
            } else if (currency === "USD") {
                totalConverted = (totalHUF / exchangeRates.USD).toFixed(2);
            }

            printWindow.document.write(`<p style="font-family: Arial; font-size: 48px; text-align: center; color: darkblue; font-weight: bold;">V√âG√ñSSZEG: ${totalConverted} ${currency}</p>`);
            const totalEUR = (totalHUF / exchangeRates.EUR).toFixed(2);
            const totalUSD = (totalHUF / exchangeRates.USD).toFixed(2);
            printWindow.document.write(`<p style="font-family: Arial; font-size: 24px; text-align: center; color: darkblue;">Doll√°rban: ${totalUSD} USD, Eur√≥ban: ${totalEUR} EUR</p>`);
            const totalWithoutVAT = (totalHUF * 0.73).toFixed(2);
            printWindow.document.write(`<p style="font-family: Arial; font-size: 24px; text-align: center; color: darkblue;">√Åfa n√©lk√ºl: (-27%) ${totalWithoutVAT} Ft</p>`);

            const dataMatrixURL = `http://bwipjs-api.metafloor.com/?bcid=pdf417&text=https://v-s.krishapps.com/?q=${totalHUF}-${paymentMethod === "K√©szp√©nz" ? "kp" : paymentMethod === "Bankk√°rtya" ? "bk" : "va"}`;
            printWindow.document.write(`<img src="${dataMatrixURL}" alt="PDF417 vonalk√≥d" style="display: block; margin: 20px auto;">`);
            printWindow.document.write('<p style="font-family: Arial; font-size: 12px; text-align: center; color: darkblue;">K√âSZ√çTVE A KRISHAPPS SHOPSYSTEM √ÅLTAL<br>NAV ELLEN≈êRZ≈ê K√ìD: KS822<br>AP: A08220123</p>');
            printWindow.document.write('</ul></body></html>');
            printWindow.document.close();
            setTimeout(() => printWindow.print(), 1000);
        }
    </script>
</body>
</html>
